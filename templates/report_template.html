<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Forenzy Networks - VAPT Report: {{ workspace }}</title>
    <style>
        :root {
            --primary: #1a237e; --secondary: #303f9f; --accent: #ff5252;
            --critical: #b71c1c; --high: #e65100; --medium: #f57f17; --low: #1b5e20; --info: #01579b;
            --bg: #f8f9fa; --white: #ffffff;
        }
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); color: #333; margin: 0; padding: 0; line-height: 1.6; }
        .cover { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: var(--white); height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .cover h1 { font-size: 3.5rem; margin: 0; letter-spacing: -1px; }
        .cover p { font-size: 1.2rem; opacity: 0.8; margin-top: 10px; }
        .container { max-width: 1100px; margin: 40px auto; padding: 0 20px; }
        .section { background: var(--white); padding: 40px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); margin-bottom: 40px; page-break-inside: avoid; }
        h2 { color: var(--primary); border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 0; display: flex; align-items: center; gap: 10px; }
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin: 30px 0; }
        .stat-card { padding: 25px; border-radius: 10px; text-align: center; color: white; }
        .stat-card.critical { background: var(--critical); } .stat-card.high { background: var(--high); }
        .stat-card.medium { background: var(--medium); } .stat-card.low { background: var(--low); }
        .stat-card.info { background: var(--info); }
        .stat-val { font-size: 3rem; font-weight: 800; display: block; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: left; padding: 15px; background: #f1f3f9; color: var(--primary); font-weight: 600; }
        td { padding: 15px; border-bottom: 1px solid #eee; vertical-align: top; }
        .badge { padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; color: white; }
        .badge.critical { background: var(--critical); } .badge.high { background: var(--high); }
        .badge.medium { background: var(--medium); } .badge.low { background: var(--low); }
        .badge.info { background: var(--info); }
        .compliance-box { border: 1px solid #e0e4ef; border-radius: 8px; margin-bottom: 15px; overflow: hidden; }
        .compliance-header { background: #f1f3f9; padding: 12px 20px; font-weight: 700; color: var(--primary); border-bottom: 1px solid #e0e4ef; }
        .compliance-body { padding: 15px 20px; }
        .footer { text-align: center; padding: 40px; color: #777; font-size: 0.85rem; }
        @media print { .cover { height: 95vh; } body { background: white; } .section { box-shadow: none; border: 1px solid #eee; } }
    </style>
</head>
<body>
    <div class="cover">
        <h1>VAPT SECURITY REPORT</h1>
        <p>Project: {{ workspace }} | Generated: {{ report_date }}</p>
        <div style="margin-top: 40px; padding: 10px 20px; border: 1px solid rgba(255,255,255,0.3); border-radius: 30px;">
            CONFIDENTIAL - FORENZY NETWORKS INTERNAL USE ONLY
        </div>
    </div>

    <div class="container">
        <div class="section">
            <h2>ðŸ“Š Executive Summary</h2>
            <p>An automated security assessment was performed on the <strong>{{ workspace }}</strong> environment. Below is the risk distribution based on the <strong>{{ total_findings }}</strong> findings discovered.</p>
            <div class="summary-grid">
                <div class="stat-card critical"><span class="stat-val">{{ critical_count }}</span>CRITICAL</div>
                <div class="stat-card high"><span class="stat-val">{{ high_count }}</span>HIGH</div>
                <div class="stat-card medium"><span class="stat-val">{{ medium_count }}</span>MEDIUM</div>
                <div class="stat-card low"><span class="stat-val">{{ low_count }}</span>LOW</div>
            </div>
        </div>

        <div class="section">
            <h2>âœ… Compliance Mapping ({{ compliance_framework|upper }})</h2>
            {% for control, findings in compliance_map.items() %}
            <div class="compliance-box">
                <div class="compliance-header">{{ control }}</div>
                <div class="compliance-body">
                    {% for f in findings %}
                    <div style="margin-bottom: 5px;">â€¢ <strong>{{ f.name }}</strong> <span class="badge {{ f.severity }}">{{ f.severity }}</span></div>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="section">
            <h2>ðŸ”§ Remediation Priority List</h2>
            <table>
                <thead>
                    <tr>
                        <th>Priority</th>
                        <th>Vulnerability</th>
                        <th>Target Host</th>
                        <th>Severity</th>
                        <th>CVSS</th>
                    </tr>
                </thead>
                <tbody>
                    {% for f in remediation_priority %}
                    <tr>
                        <td><strong>#{{ loop.index }}</strong></td>
                        <td><strong>{{ f.name }}</strong></td>
                        <td><code>{{ f.host or f.target }}</code></td>
                        <td><span class="badge {{ f.severity }}">{{ f.severity }}</span></td>
                        <td>{{ f.cvss_score or f.cvss3.base_score or 'N/A' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="footer">
        &copy; 2026 Neel Tundiya VAPT Pipeline. Generated on {{ report_date }}.
    </div>
</body>
</html>