# VAPT Pipeline Configuration
# This file contains all configurable parameters for the pipeline

# Faraday Server Configuration
faraday:
  url: "http://localhost:5985"
  api_key: "${FARADAY_API_KEY}"  # Use environment variable
  timeout: 30
  verify_ssl: false

# Nmap Scan Profiles
scan_profiles:
  quick:
    flags: "-T4 -F"
    description: "Fast scan of top 100 ports"
    timeout: 300
  full:
    flags: "-T4 -A -p-"
    description: "Comprehensive scan of all ports with service detection"
    timeout: 3600
  vuln:
    flags: "--script vuln -T4"
    description: "Vulnerability assessment scan"
    timeout: 1800

# Alert Configuration
alerts:
  enabled: true
  severity_threshold: "high"  # Trigger alerts for high and above
  channels:
    slack:
      enabled: true
      webhook_url: "${SLACK_WEBHOOK_URL}"
    email:
      enabled: false
      smtp_server: "smtp.gmail.com"
      smtp_port: 587
      from_address: "${EMAIL_FROM}"
      to_address: "${EMAIL_TO}"
  polling_interval: 60  # seconds

# Ticketing System Configuration
tickets:
  enabled: true
  severity_threshold: "high"  # Create tickets for high and above
  priority_mapping:
    critical: "P0"
    high: "P1"
    medium: "P2"
    low: "P3"
    info: "P4"

# Reporting Configuration
reporting:
  template_engine: "jinja2"
  output_format: "html"
  compliance_framework: "owasp"  # owasp or cis
  include_screenshots: false
  include_remediation: true

# Logging Configuration
logging:
  level: "INFO"
  file: "pipeline.log"
  max_file_size: 10485760  # 10MB
  backup_count: 5

# Report Directory Configuration
directories:
  reports: "./reports"
  tickets: "./tickets"
  templates: "./templates"
  logs: "./logs"

# Scan Target Configuration (can be overridden via CLI)
targets:
  default_workspace: "default_lab"
  default_profile: "quick"
  network_ranges:
    - "192.168.1.0/24"
    - "10.0.0.0/8"

# DAST Configuration (for web scanning)
dast:
  enabled: true
  tools:
    - "owasp-zap"
  zap:
    url: "http://localhost:8080"
    baseline_scan_timeout: 600
    report_format: "json"
